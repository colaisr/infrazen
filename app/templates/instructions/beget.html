{% extends "instructions_base.html" %}

{% block title %}Инструкция по подключению Beget{% endblock %}

{% block content %}
<div class="container">
    <h1><i class="fa-solid fa-book"></i>Инструкция по подключению Beget</h1>
    <p class="subtitle">Пошаговое руководство для интеграции Beget с InfraZen</p>

    <!-- Prerequisites -->
    <div class="section">
        <h2><i class="fa-solid fa-clipboard-check"></i>Требования</h2>
        <ul>
            <li>Активный аккаунт Beget</li>
            <li>Доступ к панели управления Beget</li>
        </ul>
    </div>

    <!-- Step 1: Enable Beget API -->
    <div class="section">
        <h2><span class="step-number">1</span>Включение API доступа в Beget</h2>
        
        <p>Для работы с InfraZen необходимо настроить API доступ в панели управления Beget:</p>
        
        <ol>
            <li>Войдите в <a href="https://cp.beget.com" target="_blank">панель управления Beget</a></li>
            <li>В нижней части страницы найдите и откройте раздел <strong>"Настройки аккаунта"</strong> (Account settings)</li>
        </ol>
        
        <img src="{{ url_for('static', filename='instructions/beget_step1_account_settings.png') }}" 
             alt="Beget панель управления - раздел Настройки аккаунта" 
             class="instruction-image">
        <p class="image-caption">Раздел "Настройки аккаунта" в нижней части панели управления Beget</p>
        
        <ol start="3">
            <li>Перейдите на вкладку <strong>"Ограничение доступа"</strong> (Access restriction)</li>
            <li>Выберите <strong>"Beget API"</strong></li>
            <li>Включите переключатель <strong>"Разрешить API-аутентификацию"</strong></li>
            <li>Нажмите кнопку <strong>"Установить новый пароль для API"</strong></li>
            <li>Создайте и сохраните отдельный пароль для API (он будет отличаться от вашего основного пароля)</li>
        </ol>
        
        <img src="{{ url_for('static', filename='instructions/beget_step2_api_settings.png') }}" 
             alt="Beget API настройки - включение API аутентификации" 
             class="instruction-image">
        <p class="image-caption">Настройки Beget API: включите аутентификацию и создайте API пароль</p>
        
        <div class="notice notice-warning">
            <i class="fa-solid fa-exclamation-triangle"></i>
            <strong>Критически важно:</strong> API пароль — это <strong>отдельный пароль</strong>, специально созданный для API. Не используйте пароль от вашего основного аккаунта!
        </div>
    </div>

    <!-- Step 2: Get Credentials -->
    <div class="section">
        <h2><span class="step-number">2</span>Учетные данные для InfraZen</h2>
        
        <p>После настройки API вам потребуются:</p>
        
        <h3>Имя пользователя</h3>
        <p>Ваш обычный логин (имя пользователя) в системе Beget.</p>
        
        <h3>Пароль для API</h3>
        <p><strong>Отдельный пароль для API</strong>, который вы создали на предыдущем шаге (НЕ пароль от основного аккаунта).</p>
        
        <div class="notice notice-info">
            <i class="fa-solid fa-lightbulb"></i>
            <strong>Пример:</strong> Если ваш логин <code>myusername</code>, а API пароль <code>api_secure_123</code>, то в InfraZen вы укажете именно эти данные.
        </div>
    </div>

    <!-- Step 3: Add Connection -->
    <div class="section">
        <h2><span class="step-number">3</span>Добавление подключения в InfraZen</h2>
        
        <ol>
            <li>Перейдите в раздел <strong>"Подключения"</strong></li>
            <li>Нажмите кнопку <strong>"+ Добавить подключение"</strong></li>
            <li>Выберите провайдера <strong>"Beget"</strong> из выпадающего списка</li>
            <li>Заполните поля:
                <ul>
                    <li><strong>Название подключения:</strong> Любое удобное имя (например, "Beget Production")</li>
                    <li><strong>Имя пользователя:</strong> Ваш логин Beget (обычный логин аккаунта)</li>
                    <li><strong>Пароль:</strong> Ваш API пароль (созданный в шаге 1, НЕ основной пароль)</li>
                </ul>
            </li>
            <li><strong>Обязательно:</strong> Нажмите <strong>"Тест подключения"</strong> — InfraZen проверит учетные данные и доступ к API</li>
            <li>Если тест успешен ✅, нажмите <strong>"Сохранить"</strong></li>
        </ol>
        
        <div class="notice notice-warning">
            <i class="fa-solid fa-exclamation-triangle"></i>
            <strong>Важно:</strong> Всегда тестируйте подключение перед сохранением! Это гарантирует, что ваши учетные данные верны и API доступ настроен правильно.
        </div>
    </div>

    <!-- Step 4: Sync -->
    <div class="section">
        <h2><span class="step-number">4</span>Синхронизация данных</h2>
        
        <p>После сохранения подключения вы можете запустить синхронизацию одним из способов:</p>
        
        <h3>Вариант 1: Ручная синхронизация (рекомендуется для первого раза)</h3>
        <ul>
            <li><strong>Синхронизация конкретного провайдера:</strong> На карточке подключения нажмите кнопку <strong>"Синхронизировать"</strong></li>
            <li><strong>Полная синхронизация:</strong> В разделе "Подключения" нажмите <strong>"Синхронизировать все"</strong></li>
        </ul>
        
        <h3>Вариант 2: Автоматическая синхронизация</h3>
        <p>InfraZen автоматически синхронизирует данные каждое утро по расписанию.</p>
        
        <h3>Что будет синхронизировано:</h3>
        <ul>
            <li>VPS серверы (конфигурация, использование CPU/RAM/HD)</li>
            <li>Виртуальный хостинг</li>
            <li>S3 хранилища</li>
            <li>MySQL базы данных</li>
            <li>Стоимость всех ресурсов</li>
        </ul>
        
        <div class="notice notice-info">
            <i class="fa-solid fa-lightbulb"></i>
            <strong>Совет:</strong> Первая синхронизация может занять 1-2 минуты в зависимости от количества ресурсов. Рекомендуется запустить её вручную сразу после добавления подключения.
        </div>
    </div>

    <!-- Support -->
    <div class="section">
        <h2><i class="fa-solid fa-life-ring"></i>Нужна помощь?</h2>
        <p>
            Если у вас возникли проблемы с подключением Beget, свяжитесь с нашей службой поддержки или ознакомьтесь с 
            <a href="https://beget.com/ru/kb" target="_blank">документацией Beget</a>.
        </p>
    </div>

    <!-- Back Button -->
    <div class="actions">
        <button onclick="window.close()" class="btn btn-secondary">
            <i class="fa-solid fa-arrow-left"></i> Закрыть
        </button>
    </div>
</div>
{% endblock %}

