{% extends "base.html" %}

{% block title %}Рекомендации - InfraZen{% endblock %}

{% block page_title %}Рекомендации{% endblock %}
{% block page_subtitle %}Оптимизация расходов и рекомендации{% endblock %}

{% block header_actions %}
<div style="display: flex; gap: 1rem; align-items: center;">
    
    <button id="exportCsv" class="btn btn-secondary">Экспорт CSV</button>
    <a href="/resources" class="btn btn-link">К ресурсам</a>
    </div>
{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/pages/recommendations.css') }}">
{% endblock %}

{% block content %}
<!-- Pass template variables to JavaScript -->
<script>
window.INFRAZEN_DATA = window.INFRAZEN_DATA || {};
window.INFRAZEN_DATA.isDemoUser = {{ 'true' if user.role == 'demouser' else 'false' }};
window.INFRAZEN_DATA.enableAIRecommendations = {{ 'true' if enable_ai_recommendations else 'false' }};
window.INFRAZEN_DATA.agentServiceUrl = '{{ agent_service_url }}';
</script>


<div class="filters" style="margin-bottom: 1rem; display: grid; grid-template-columns: repeat(6, minmax(140px, 1fr)); gap: 0.75rem;">
    <input id="search" class="input" placeholder="Поиск..." />
    <select id="provider" class="input">
        <option value="">Все провайдеры</option>
    </select>
    <select id="status" class="input">
        <option value="">Все статусы</option>
        <option value="pending" selected>Новые</option>
        <option value="implemented">Внедрены</option>
        <option value="dismissed">Скрыты</option>
    </select>
    <select id="severity" class="input">
        <option value="">Все уровни</option>
        <option value="critical">Критическая</option>
        <option value="high">Высокая</option>
        <option value="medium">Средняя</option>
        <option value="low">Низкая</option>
        <option value="info">Инфо</option>
    </select>
    <select id="type" class="input">
        <option value="">Все типы</option>
        <option value="rightsizing">Изменить размер</option>
        <option value="shutdown">Остановить</option>
        <option value="migrate">Миграция</option>
        <option value="cleanup">Очистить</option>
    </select>
    <select id="resource_type" class="input">
        <option value="">Все ресурсы</option>
        <option value="VM">VM</option>
        <option value="volume">Том</option>
        <option value="bucket">Хранилище</option>
    </select>
</div>

<div class="rec-list" id="recsList"></div>

<div id="recModal" class="modal" style="display:none;">
  <div class="modal-content">
    <div style="display:flex; justify-content: space-between; align-items:center;">
      <h3 id="modalTitle">Рекомендация</h3>
      <button id="modalClose" class="btn btn-secondary">Закрыть</button>
    </div>
    <div id="modalBody"></div>
  </div>
  <div class="modal-backdrop"></div>
  </div>

<!-- External JavaScript -->
<script src="{{ url_for('static', filename='js/main.js') }}"></script>
<script src="{{ url_for('static', filename='js/recommendations.js') }}"></script>
{% endblock %}



